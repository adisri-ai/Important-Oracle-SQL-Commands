--Assignment-1
CREATE TABLE Salgrade(
   GRADE INT PRIMARY KEY,
   LOSAL INT,
   HISAL INT
);
SELECT * FROM Salgrade;
CREATE TABLE Emp(
   EMPNO INT PRIMARY KEY,
   ENAME VARCHAR(50),
   "JOB" VARCHAR(50),
   MGR INT,
   HIREDATE DATE,
   SAL INT,
   COMM INT,
   DEPTNO INT
);
SELECT * FROM Emp;
CREATE TABLE Dept(
   DEPTNO INT PRIMARY KEY,
   DNAME VARCHAR(50),
   LOC VARCHAR(50)
);
SELECT * FROM Dept;
INSERT INTO Salgrade VALUES(1, 700, 1200);
INSERT INTO Salgrade VALUES( 2 , 1201 , 1400);
INSERT INTO Salgrade VALUES( 3 , 1401 , 2000);
INSERT INTO Salgrade VALUES (4 , 2001 , 3000);
INSERT INTO Emp VALUES(7369 , 'SMITH' , 'CLERK' , 7902 , TO_DATE('17-DEC-80' , 'DD-MON-YYYY') , 800 , NULL ,20);
INSERT INTO Emp VALUES(7499 , 'ALLEN' , 'SALESMAN' , 7698 , TO_DATE('20-FEB-81','DD-MON-YY') , 1600 , 300 , 30);
INSERT INTO Emp VALUES(7521 , 'WARD' , 'SALESMAN' , 7698 , TO_DATE('22-FEB-81','DD-MON-YY') , 1250 , 500 , 30);
INSERT INTO Emp VALUES(7566 , 'JONES' , 'MANAGER' , 7839 , TO_DATE('02-APR-81','DD-MON-YY') , 2975 , NULL , 20);
INSERT INTO Emp VALUES(7654 , 'MARTIN' , 'SALESMAN' , 7698 , TO_DATE('28-SEP-81','DD-MON-YY') , 1250 , 1400 , 30);
INSERT INTO Emp VALUES(7698 , 'BLAKE' , 'MANAGER' , 7839 , TO_DATE('01-MAY-81','DD-MON-YY') , 2850 , NULL , 30);
INSERT INTO Emp VALUES(7782 , 'CLARK' , 'MANAGER' , 7839 , TO_DATE('09-JUN-81','DD-MON-YY') , 2450 , NULL , 10);
INSERT INTO Emp VALUES(7788 , 'SCOTT' , 'ANALYST' , 7566 , TO_DATE('19-APR-87','DD-MON-YY') , 3000 , NULL , 20);
INSERT INTO Emp VALUES(7839 , 'KING' , 'PRESIDENT' , NULL , TO_DATE('17-NOV-81','DD-MON-YY') , 5000 , NULL , 10);
INSERT INTO Emp VALUES(7844 , 'TURNER' , 'SALESMAN' , 7698 , TO_DATE('08-SEP-81','DD-MON-YY') , 1500 , 0 , 30);
INSERT INTO Emp VALUES(7876 , 'ADAMS' , 'CLERK' , 7788 , TO_DATE('23-MAY-87','DD-MON-YY') , 1100 , NULL , 20);
INSERT INTO Emp VALUES(7900 , 'JAMES' , 'CLERK' , 7698 , TO_DATE('03-DEC-81','DD-MON-YY') , 950 , NULL , 30);
INSERT INTO Emp VALUES(7902 , 'FORD' , 'ANALYST' , 7566 , TO_DATE('03-DEC-81','DD-MON-YY') , 3000 , NULL , 20);
INSERT INTO Emp VALUES(7934 , 'MILLER' , 'CLERK' , 7782 , TO_DATE('23-JAN-82','DD-MON-YY') , 1300 , NULL , 10);
INSERT INTO Dept VALUES(10, 'ACCOUNTING' , 'NEW YORK');
INSERT INTO Dept VALUES(20, 'RESEARCH' , 'DALLAS');
INSERT INTO Dept VALUES(30, 'SALES' , 'CHICAGO');
INSERT INTO Dept VALUES(40, 'OPERATIONS' , 'BOSTON');
SELECT * FROM Salgrade;
SELECT * FROM Emp;
SELECT * FROM Dept;
DESCRIBE Salgrade;
DESCRIBE EMP;
DESCRIBE Dept;
SELECT * FROM Emp WHERE (SAL>=1000 AND SAL<=3000);
SELECT ENAME,SAL FROM Emp;
SELECT ENAME,SAL FROM Emp
ORDER BY ENAME ASC;
SELECT ENAME , DEPTNO FROM EMP WHERE
DEPTNO IN (10,30);
SELECT ENAME , "JOB" FROM Emp 
WHERE DEPTNO IN (20) AND "JOB" = 'CLERK';
SELECT ENAME , "JOB" FROM Emp 
WHERE DEPTNO IN (20,30) AND "JOB"='CLERK';
SELECT * FROM Emp WHERE SUBSTR(ENAME , 1 , 1) = 'S';
SELECT * FROM EMP WHERE LENGTH(ENAME)  = 4;
SELECT * FROM EMP WHERE SUBSTR(ENAME , LENGTH(ENAME) , 1) = 'L';
SELECT * FROM EMP WHERE MGR IS NOT NULL;
SELECT * FROM EMP WHERE MGR IS NULL;
SELECT ENAME , SAL+NVL(COMM,0) AS Total_Salary FROM Emp;
SELECT ENAME , SAL*12 AS Annual_Salary FROM EMP;
SELECT ENAME FROM EMP WHERE EXTRACT(YEAR FROM HIREDATE)=1991;
SELECT ENAME || ' HAS HELD THE POSITION OF ' || "JOB" || ' IN DEPARTMENT'  || DEPTNO ||
' SINCE ' || TO_CHAR(HIREDATE , 'DD-MON-YYYY') || ' AND EARNS ' || SAL 
AS EMPLOYEE_INFO FROM EMP;
SELECT * FROM EMP WHERE JOB='&job';
SELECT * FROM EMP WHERE HIREDATE = TO_DATE('&date' , 'DD-MON-YYYY');
SELECT ENAME FROM EMP WHERE (HIREDATE<=TO_DATE('&&END_DATE' , 'DD-MON-YYYY') AND HIREDATE>=TO_DATE('&&START_DATE',  'DD-MON-YYYY'));
WITH REM AS (
 SELECT sal*12 + NVL(comm , 0) AS "REM" FROM EMP
)
SELECT "REM" FROM REM WHERE "REM">=10000;
CREATE TABLE EMP10(
    Empno NUMBER(2),
    Ename VARCHAR(25),
    Date_join DATE,
    Deptno NUMBER(2),
    Salary NUMBER(10 , 2),
    "Job" VARCHAR2(10),
    Comm NUMBER(7 , 2)
);
CREATE TABLE EMP10_NEW(
   Empno NUMBER(2),
   Ename VARCHAR(25),
   Date_join DATE,
   Deptno NUMBER(2),
   Salary NUMBER(10 ,2),
   "Job" VARCHAR2(10),
   Comm NUMBER(7,2)
);
create table emp20 as(
  select empno as employee_number ,
  ename as employe_name , "JOB" as "work" , 
  MGR as "manager" ,HIREDATE as join_date , 
  SAL as salary , COMM as commission , 
  DEPTNO as department
  from emp where DEPTNO = 20
);
select * from emp20;
--Assignment2
create table programmer(
  PNAME VARCHAR2(15),
  DOB DATE,
  DOJ DATE,
  SEX VARCHAR(1) CHECK(SEX IN ('M' , 'F')),
  PROF1 VARCHAR(15),
  PROF2 VARCHAR(15),
  SALARY INT
);
INSERT INTO programmer VALUES ('ANAND', TO_DATE('12-APR-66','DD-MON-RR'), TO_DATE('21-APR-92','DD-MON-RR'), 'M', 'PASCAL', 'BASIC', 3200);
INSERT INTO programmer VALUES ('ALTAF', TO_DATE('02-JUL-64','DD-MON-RR'), TO_DATE('13-NOV-90','DD-MON-RR'), 'M', 'CLIPPER', 'COBOL', 2800);
INSERT INTO programmer VALUES ('JULIANA', TO_DATE('31-JAN-60','DD-MON-RR'), TO_DATE('21-APR-90','DD-MON-RR'), 'F', 'COBOL', 'DBASE', 3000);
INSERT INTO programmer VALUES ('KAMALA', TO_DATE('30-OCT-68','DD-MON-RR'), TO_DATE('02-JAN-92','DD-MON-RR'), 'F', 'C', 'DBASE', 2900);
INSERT INTO programmer VALUES ('MARY', TO_DATE('24-JUN-70','DD-MON-RR'), TO_DATE('01-FEB-91','DD-MON-RR'), 'F', 'CPP', 'ORACLE', 4500);
INSERT INTO programmer VALUES ('NELSON', TO_DATE('11-SEP-85','DD-MON-RR'), TO_DATE('11-MAR-89','DD-MON-RR'), 'M', 'COBOL', 'DBASE', 2500);
INSERT INTO programmer VALUES ('PATTRICK', TO_DATE('10-NOV-65','DD-MON-RR'), TO_DATE('21-APR-90','DD-MON-RR'), 'M', 'PASCAL', NULL, 2800);
INSERT INTO programmer VALUES ('QADIR', TO_DATE('31-AUG-65','DD-MON-RR'), TO_DATE('21-APR-90','DD-MON-RR'), 'M', 'ASSEMBLY', 'C', 3000);
INSERT INTO programmer VALUES ('RAMESH', TO_DATE('03-MAY-67','DD-MON-RR'), TO_DATE('26-FEB-91','DD-MON-RR'), 'M', 'PASCAL', 'DBASE', 3200);
INSERT INTO programmer VALUES ('REBECCA', TO_DATE('01-JAN-67','DD-MON-RR'), TO_DATE('01-DEC-90','DD-MON-RR'), 'F', 'BASIC', 'COBOL', 2500);
INSERT INTO programmer VALUES ('REMITHA', TO_DATE('19-APR-70','DD-MON-RR'), TO_DATE('20-APR-93','DD-MON-RR'), 'F', 'C', 'ASSEMBLY', 3000);
INSERT INTO programmer VALUES ('REVATHI', TO_DATE('02-DEC-69','DD-MON-RR'), TO_DATE('02-JAN-92','DD-MON-RR'), 'F', 'PASCAL', 'BASIC', 3200);
INSERT INTO programmer VALUES ('VIJAYA', TO_DATE('14-DEC-65','DD-MON-RR'), TO_DATE('02-MAY-92','DD-MON-RR'), 'F', 'FOXPRO', 'C', 4500);
create table software(
  PNAME VARCHAR(20),
  TITLE VARCHAR(20),
  DEVELOPING VARCHAR(20),
  SCOST NUMBER(10,2),
  DCOST INT,
  SOLD INT
);
INSERT INTO software (PNAME, TITLE, DEVELOPING, SCOST, DCOST, SOLD) VALUES ('MARY', 'README', 'CPP', 100.00, 1200, 84);
INSERT INTO software (PNAME, TITLE, DEVELOPING, SCOST, DCOST, SOLD) VALUES ('ANAND', 'PARACHUTES', 'BASIC', 399.95, 6000, 43);
INSERT INTO software (PNAME, TITLE, DEVELOPING, SCOST, DCOST, SOLD) VALUES ('ANAND', 'VIDEOTITLING', 'PASCAL', 7500.00, 16000, 9);
INSERT INTO software (PNAME, TITLE, DEVELOPING, SCOST, DCOST, SOLD) VALUES ('JULIANA', 'INVENTORY', 'COBOL', 3000.00, 3500, 0);
INSERT INTO software (PNAME, TITLE, DEVELOPING, SCOST, DCOST, SOLD) VALUES ('KAMALA', 'PAYROLLPRG', 'DBASE', 9000.00, 20000, 7);
INSERT INTO software (PNAME, TITLE, DEVELOPING, SCOST, DCOST, SOLD) VALUES ('MARY', 'FINANCIALACC', 'ORACLE', 18000.00, 85000, 4);
INSERT INTO software (PNAME, TITLE, DEVELOPING, SCOST, DCOST, SOLD) VALUES ('MARY', 'CODEGENRRATOP', 'C', 4500.00, 20000, 23);
INSERT INTO software (PNAME, TITLE, DEVELOPING, SCOST, DCOST, SOLD) VALUES ('PATTRICK', 'README', 'CPP', 300.00, 1200, 84);
INSERT INTO software (PNAME, TITLE, DEVELOPING, SCOST, DCOST, SOLD) VALUES ('QADIR', 'BOMBSAWAY', 'ASSEMBLY', 750.00, 5000, 11);
INSERT INTO software (PNAME, TITLE, DEVELOPING, SCOST, DCOST, SOLD) VALUES ('QADIR', 'VACCINES', 'C', 1900.00, 3400, 21);
INSERT INTO software (PNAME, TITLE, DEVELOPING, SCOST, DCOST, SOLD) VALUES ('RAMESH', 'HOTLIMGMT', 'DBASE', 12000.00, 35000, 4);
INSERT INTO software (PNAME, TITLE, DEVELOPING, SCOST, DCOST, SOLD) VALUES ('RAMESH', 'DEADLEE', 'PASCAL', 599.95, 4500, 73);
INSERT INTO software (PNAME, TITLE, DEVELOPING, SCOST, DCOST, SOLD) VALUES ('REMITHA', 'PCUTILITIES', 'C', 725.00, 5000, 51);
INSERT INTO software (PNAME, TITLE, DEVELOPING, SCOST, DCOST, SOLD) VALUES ('REMITHA', 'TSRHELPPKG', 'ASSEMBLY', 2500.00, 6000, 7);
INSERT INTO software (PNAME, TITLE, DEVELOPING, SCOST, DCOST, SOLD) VALUES ('REVATHI', 'HOSPITALMGMT', 'PASCAL', 1100.00, 75000, 2);
INSERT INTO software (PNAME, TITLE, DEVELOPING, SCOST, DCOST, SOLD) VALUES ('VIJAYA', 'TSREDITOR', 'C', 900.00, 700, 6);
create table studies(
   PNAME VARCHAR(20),
   INSTITUE VARCHAR(20),
   COURSE VARCHAR(10),
   COURSEFEE INT
);
INSERT INTO studies VALUES ('ANAND' , 'SABHARI' , 'PGDCA' , 4500);
INSERT INTO studies VALUES ('ATLAF' , 'COIT' , 'DCA' , 7200);
INSERT INTO studies VALUES ('JULIANA' , 'BITS' , 'MCA' , 22000);
INSERT INTO studies VALUES ('KAMALA' , 'PRAGATHI' , 'DCP' , 5000);
INSERT INTO studies VALUES ('MARY' , 'SABHARI' , 'PGDCA' , 4500);
INSERT INTO studies VALUES ('NELSON' , 'PRAGATHI' , 'DAP' , 6200);
INSERT INTO studies VALUES ('PATRICK' , 'PRAGATHI' , 'DCAP' , 5200);
INSERT INTO studies VALUES ('QADRIK' , 'APPLE' , 'HDCP' , 14000);
INSERT INTO studies VALUES ('RAMESH' , 'SABHARI' , 'PGDCA' , 4500);
INSERT INTO studies VALUES ('RESECCA' , 'BRILLIANT' , 'DCAP' , 11000);
INSERT INTO studies VALUES ('REMITHA' , 'DCS' , 'DCS' , 6000);
INSERT INTO studies VALUES ('VIJAYA' , 'DCA' , 'DCA' , 48000);
SELECT AVG(SCOST) AVERAGE FROM software WHERE DEVELOPING='PASCAL'; --1
SELECT PNAME AS "NAME" , EXTRACT(YEAR FROM dob) - EXTRACT(YEAR FROM SYSDATE) AS Age FROM programmer; --2
SELECT PNAME FROM STUDIES WHERE COURSE = 'DAP'; --3
SELECT PNAME FROM PROGRAMMER WHERE EXTRACT(MONTH FROM DOB)=1; --4
SELECT PNAME , MAX(SOLD)AS MAX_COPIES FROM SOFTWARE GROUP BY(PNAME); --5
SELECT MIN(COURSEFEE)AS MINIMUM_COURSEFEE FROM STUDIES; --6
SELECT COUNT(*) AS "STUDENTS WITH PGDCA COURSE" FROM STUDIES WHERE COURSE='PGDCA'; --7
SELECT SUM(SCOST) AS "SALES REVENUE FROM C" FROM SOFTWARE WHERE DEVELOPING='C'; --8
SELECT TITLE AS "SOFTWARES BY RAMESH" , DEVELOPING ,  SCOST , DCOST , SOLD FROM SOFTWARE WHERE PNAME='RAMESH'; --9
SELECT COUNT(*) AS "PROGRAMMERS FROM SABHARI" FROM STUDIES WHERE INSTITUE = 'SABHARI'; --10
SELECT TITLE AS "PACKAGE NAME" , SUM(SCOST*SOLD) AS SALES , SUM(DCOST) AS DEVELOPMENT_COST FROM SOFTWARE  --11
GROUP BY TITLE HAVING SUM(SCOST)*SUM(SOLD)>=2000;
SELECT TITLE AS "PACKAGE NAME" , SUM(SCOST*SOLD) AS SALES , SUM(DCOST) AS DEVELOPMENT_COST FROM SOFTWARE  --12
GROUP BY TITLE HAVING SUM(SCOST)*SUM(SOLD)>=SUM(DCOST);
WITH BASIC_SOFTWARES AS( --13
  SELECT TITLE , SUM(DCOST) AS "COST" FROM SOFTWARE WHERE DEVELOPING = 'BASIC' GROUP BY TITLE
) 
SELECT MAX("COST") AS MAX_COST FROM BASIC_SOFTWARES;
WITH FROM_DBASE AS ( --14
  SELECT DISTINCT TITLE FROM SOFTWARE WHERE DEVELOPING = 'DBASE'
)
SELECT COUNT(*) AS NUMBER_OF_SOFTWARES FROM FROM_DBASE; --15
SELECT COUNT(*) AS NUMBER_FROM_PRAGATHI FROM STUDIES WHERE INSTITUE = 'PRAGATHI'; --16
SELECT COUNT(*) AS NUMBER_OF_PROGRAMMERS FROM STUDIES WHERE (COURSEFEE>=5000 AND COURSEFEE<=10000); --17
SELECT ROUND(AVG(COURSEFEE),2) AS AVG_FEES FROM STUDIES; --18
SELECT * FROM SOFTWARE WHERE DEVELOPING = 'C'; --19
SELECT COUNT(*) AS NUMBER_OF_PROGRAMMERS FROM PROGRAMMER WHERE (PROF1 IN ('COBOL' , 'PASCAL') OR PROF2 IN ('COBOL' , 'PASCAL')); --20
SELECT COUNT(*) AS NUMBER_OF_PROGRAMMERS FROM PROGRAMMER WHERE (PROF1 NOT IN ('C' , 'PASCAL') AND PROF2 NOT IN ('C' , 'PASCAL')); --21
SELECT  EXTRACT(YEAR FROM SYSDATE) - EXTRACT(YEAR FROM MIN(DOB)) AS AGE_OF_OLDEST_MALE FROM PROGRAMMER; --22
WITH TEMP AS(
  SELECT DISTINCT PNAME , EXTRACT(YEAR FROM SYSDATE) - EXTRACT (YEAR FROM DOJ) AS "EXPERIENCE" FROM PROGRAMMER
) 
SELECT PNAME , "EXPERIENCE" FROM TEMP ORDER BY PNAME DESC; --23
SELECT PNAME FROM PROGRAMMER WHERE EXTRACT(MONTH FROM DOB) = EXTRACT(MONTH FROM SYSDATE); --24
SELECT COUNT(*) AS NUMBER_OF_FEMALE_PROGRAMMERS FROM PROGRAMMER WHERE SEX='F'; --25
WITH LANGUAGES AS (
    SELECT DISTINCT PROF1 AS "LANGS" FROM PROGRAMMER WHERE SEX = 'M'
    UNION
    SELECT DISTINCT PROF2 AS "LANGS" FROM PROGRAMMER WHERE SEX = 'M'
)
SELECT * FROM LANGUAGES WHERE LANGS IS NOT NULL; --26
SELECT ROUND(AVG(SALARY),2) AS AVG_SALARY FROM PROGRAMMER; --27
SELECT COUNT(*)AS NUMBER_OF_PROGRAMMERS FROM PROGRAMMER WHERE (SALARY>=2000 AND SALARY<=4000); --28
SELECT * FROM PROGRAMMER WHERE (PROF1 NOT IN ('COBOL' , 'PASCAL' , 'CLIPPER') AND PROF2 NOT IN('COBOL' , 'PASCAL' , 'CLIPPER')); --29
SELECT PNAME , SUM(DCOST) AS TOTAL_COST FROM SOFTWARE GROUP BY PNAME;--30
SELECT PNAME , SUM(SCOST*SOLD) AS SALES FROM SOFTWARE GROUP BY PNAME; --31
SELECT PNAME , COUNT(DISTINCT TITLE ) FROM SOFTWARE GROUP BY PNAME; --32
SELECT PNAME , SUM(SCOST) AS TOTAL_SALES_COST FROM SOFTWARE GROUP BY PNAME; --33
SELECT PNAME , DEVELOPING , SUM(SCOST) FROM SOFTWARE GROUP BY PNAME , DEVELOPING; --34
SELECT DEVELOPING , AVG(DCOST)AS AVG_DEVCOST , AVG(SCOST) AS AVG_SALES_COST , AVG(SCOST*SOLD)AS AVERAGE_SALES FROM SOFTWARE GROUP BY DEVELOPING; --35
WITH COST_RANKINGS_DESC AS(
  SELECT PNAME , TITLE ,ROW_NUMBER() OVER(PARTITION BY PNAME ORDER BY DCOST DESC) AS RN FROM SOFTWARE
),
COST_RANKINGS_ASC AS (
  SELECT PNAME , TITLE ,ROW_NUMBER() OVER(PARTITION BY PNAME ORDER BY DCOST ASC) AS RN FROM SOFTWARE
),
COSTLIEST AS(
  SELECT PNAME , TITLE FROM COST_RANKINGS_DESC WHERE RN=1
),
CHEAPEST AS(
   SELECT PNAME , TITLE FROM COST_RANKINGS_ASC WHERE RN  = 1
)
SELECT COSTLIEST.PNAME , COSTLIEST.TITLE AS "COSTLIEST" , CHEAPEST.TITLE AS "CHEAPEST" FROM COSTLIEST
LEFT JOIN CHEAPEST ON COSTLIEST.PNAME = CHEAPEST.PNAME; --36
SELECT PNAME , MIN(DCOST) AS "CHEAPEST" , MAX(DCOST) AS "COSTILIEST" FROM SOFTWARE GROUP BY PNAME; --37
SELECT INSTITUE , COUNT(DISTINCT COURSE) AS "COURSE_COUNT", ROUND(AVG(COURSEFEE), 2) AS "AVG FEE" FROM STUDIES GROUP BY INSTITUE; --38
SELECT INSTITUE , COUNT(PNAME)AS NUMBER_OF_STUDENTS FROM STUDIES GROUP BY INSTITUE; --39
SELECT PNAME , CASE WHEN SEX='M' THEN 'MALE' ELSE 'FEMALE' END  AS "SEX" FROM PROGRAMMER; --40
SELECT PNAME , TITLE AS PACKAGE FROM SOFTWARE ORDER BY PNAME ASC; --41
SELECT DEVELOPING , COUNT(TITLE) AS NUM_PACKAGES FROM SOFTWARE WHERE DEVELOPING NOT IN ('C','C++') GROUP BY DEVELOPING; --42
SELECT DEVELOPING , COUNT(*) AS NUM_PACKAGES FROM SOFTWARE WHERE DCOST<1000 GROUP BY DEVELOPING; --43
SELECT AVG(SCOST-DCOST) AS "AVERAGE_DIFFERENCE" FROM SOFTWARE; --44
SELECT SCOST , DCOST , (DCOST-(SCOST*SOLD)) AS "AMOUNT TO RECOVER" FROM SOFTWARE WHERE ((SCOST*SOLD)<DCOST); --45
SELECT MAX(SALARY) AS "HIGHEST SALARY" , MIN(SALARY) AS "LOWEST SALARY" , ROUND(AVG(SALARY),2) AS "AVERAGE SALARY" FROM PROGRAMMER WHERE SALARY>2000; --46
SELECT DISTINCT PNAME FROM PROGRAMMER WHERE (PROF1='C' OR PROF2='C') AND SALARY = (SELECT MAX(SALARY) FROM PROGRAMMER WHERE (PROF1='C' OR PROF2='C'));--47
SELECT DISTINCT PNAME FROM PROGRAMMER WHERE SEX='F' AND (PROF1='COBOL' OR PROF2='COBOL') --47
AND SALARY = (SELECT MAX(SALARY) FROM PROGRAMMER WHERE SEX='F' AND (PROF1 ='COBOL' OR PROF2 = 'COBOL'));
WITH PROGS AS(
  SELECT PNAME , PROF1 AS "LANG" , SALARY  FROM PROGRAMMER
  UNION
  SELECT PNAME , PROF2 AS "LANG", SALARY FROM PROGRAMMER
),
RANKINGS AS(
  SELECT PNAME , "LANG" , ROW_NUMBER() OVER (PARTITION BY "LANG" ORDER BY SALARY DESC) AS RN FROM PROGS
)
SELECT PNAME , "LANG" FROM RANKINGS WHERE RN=1 AND "LANG" IS NOT NULL; ---48
SELECT DISTINCT PNAME FROM PROGRAMMER WHERE SYSDATE-DOB = (SELECT MIN(SYSDATE-DOB) FROM PROGRAMMER); --49
SELECT DISTINCT PNAME FROM PROGRAMMER WHERE SEX = 'M' AND (PROF1 ='PASCAL' OR PROF2='PASCAL') AND 
SYSDATE-DOJ = (SELECT MAX(SYSDATE-DOJ) FROM PROGRAMMER WHERE SEX = 'M' AND (PROF1 ='PASCAL' OR PROF2='PASCAL')); --50
select * from programmer;
WITH PROF1 AS(
  SELECT PROF1 AS "LANG" , COUNT(*) AS "COUNT1" FROM PROGRAMMER  GROUP BY PROF1
),
PROF2 AS(
  SELECT PROF2 AS "LANG" , COUNT(*) AS "COUNT2" FROM PROGRAMMER GROUP BY PROF2
),
PROF3 AS(
  SELECT P1.LANG AS "LANG" , P1.COUNT1 AS "COUNT1" , P2.COUNT2 AS "COUNT2" FROM PROF1 P1
  FULL OUTER JOIN
  PROF2 P2 ON P1.LANG = P2.LANG
)
SELECT DISTINCT LANG FROM PROF3 WHERE NVL(COUNT1 , 0) + NVL(COUNT2 , 0) = 1 AND LANG IS NOT NULL; --51
WITH PROF1 AS(
  SELECT PROF1 AS "LANG" , COUNT(*) AS "COUNT1" FROM PROGRAMMER  GROUP BY PROF1
),
PROF2 AS(
  SELECT PROF2 AS "LANG" , COUNT(*) AS "COUNT2" FROM PROGRAMMER GROUP BY PROF2
),
PROF3 AS(
  SELECT P1.LANG AS "LANG" , P1.COUNT1 AS "COUNT1" , P2.COUNT2 AS "COUNT2" FROM PROF1 P1
  FULL OUTER JOIN
  PROF2 P2 ON P1.LANG = P2.LANG
)
,LANGS AS (
 SELECT DISTINCT LANG FROM PROF3 WHERE NVL(COUNT1 , 0) + NVL(COUNT2 , 0) = 1 AND LANG IS NOT NULL
 )
SELECT PNAME FROM PROGRAMMER WHERE PROF1 IN (SELECT * FROM LANGS) OR PROF2 IN (SELECT * FROM LANGS); --52
SELECT PNAME FROM PROGRAMMER WHERE (PROF1 = 'DBASE' OR PROF2='DBASE') AND 
SYSDATE-DOB = (SELECT MIN(SYSDATE-DOB) FROM PROGRAMMER WHERE (PROF1 = 'DBASE' OR PROF2='DBASE')); --53
SELECT PNAME FROM PROGRAMMER WHERE SEX = 'F' AND PROF1 NOT IN ('C' , 'C++' , 'ORACLE' , 'DBASE') AND 
PROF2 NOT IN ('C' , 'C++' , 'ORACLE' , 'DBASE'); --54
SELECT INSTITUE FROM STUDIES GROUP BY INSTITUE HAVING COUNT(*) = (SELECT MAX(COUNT(*)) FROM STUDIES GROUP BY INSTITUE); --55
SELECT DISTINCT COURSE FROM STUDIES WHERE COURSEFEE = (SELECT MAX(COURSEFEE) FROM STUDIES); -- 56
SELECT COURSE FROM STUDIES GROUP BY COURSE HAVING COUNT(*) = (SELECT MAX(COUNT(*)) FROM STUDIES GROUP BY COURSE); --57
SELECT COURSE FROM STUDIES GROUP BY COURSE HAVING COUNT(*) = (SELECT MAX(COUNT(*)) FROM STUDIES GROUP BY COURSE); --58
SELECT DISTINCT INSTITUE FROM STUDIES WHERE COURSEFEE = (SELECT MAX(COURSEFEE) FROM STUDIES); --59
SELECT INSTITUE , COURSE FROM STUDIES WHERE COURSEFEE < (SELECT AVG(COURSEFEE) FROM STUDIES); --60
SELECT DISTINCT COURSE FROM STUDIES WHERE COURSEFEE <= 1000+(SELECT AVG(COURSEFEE) FROM STUDIES) AND COURSEFEE >= (SELECT AVG(COURSEFEE) FROM STUDIES)-1000; --61
SELECT DISTINCT TITLE FROM SOFTWARE WHERE DCOST = (SELECT MAX(DCOST) FROM SOFTWARE); --62
SELECT COURSE FROM STUDIES GROUP BY COURSE HAVING COUNT(*)< (SELECT AVG(COUNT(*)) FROM STUDIES GROUP BY COURSE); --63
SELECT DISTINCT TITLE FROM SOFTWARE WHERE SCOST = (SELECT MIN(SCOST) FROM SOFTWARE); --64
SELECT DISTINCT PNAME FROM SOFTWARE WHERE SOLD = (SELECT MIN(SOLD) FROM SOFTWARE); --65
SELECT DISTINCT DEVELOPING FROM SOFTWARE WHERE SCOST*SOLD = (SELECT MAX(SCOST*SOLD) FROM SOFTWARE); --66
SELECT DISTINCT SOLD FROM SOFTWARE WHERE SCOST-DCOST = (SELECT MIN(SCOST-DCOST) FROM SOFTWARE) ;--67
SELECT MAX(DCOST) FROM SOFTWARE WHERE DEVELOPING = 'PASCAL'; --68
SELECT DEVELOPING FROM SOFTWARE GROUP BY DEVELOPING HAVING COUNT(*) = (SELECT MAX(COUNT(*)) FROM SOFTWARE GROUP BY DEVELOPING); --69
SELECT PNAME FROM SOFTWARE GROUP BY PNAME HAVING COUNT(*) = (SELECT MAX(COUNT(*)) FROM SOFTWARE GROUP BY PNAME); --70
SELECT DISTINCT TITLE FROM SOFTWARE WHERE SOLD < (SELECT AVG(SOLD) FROM SOFTWARE); --71
SELECT DISTINCT PNAME FROM SOFTWARE WHERE SOLD*SCOST >= 2*DCOST; --72
WITH RANKINGS AS (
  SELECT PNAME , DEVELOPING , TITLE , ROW_NUMBER() OVER(PARTITION BY PNAME , DEVELOPING ORDER BY DCOST , TITLE ASC) AS "RANK" FROM SOFTWARE
)
SELECT PNAME , DEVELOPING , TITLE FROM RANKINGS WHERE "RANK" = 1; --73
WITH RANKINGS_LOWEST AS (
  SELECT PNAME , DEVELOPING , ROW_NUMBER() OVER(PARTITION BY PNAME ORDER BY DCOST , TITLE ASC) AS "RANK" FROM SOFTWARE
),
RANKING_HIGHEST AS(
  SELECT PNAME , DEVELOPING , ROW_NUMBER() OVER(PARTITION BY PNAME ORDER BY DCOST , TITLE DESC) AS "RANK" FROM SOFTWARE
),
HIGHEST_LANG AS(
  SELECT PNAME , DEVELOPING FROM RANKING_HIGHEST WHERE "RANK" = 1
),
LOWEST_LANG AS(
  SELECT PNAME , DEVELOPING FROM RANKINGS_LOWEST WHERE "RANK" = 1
),
MERGED AS(
  SELECT S.PNAME , H.DEVELOPING AS "HIGHEST_LANGUGAGE" , L.DEVELOPING AS "LOWEST_LANGUAGE" FROM SOFTWARE S
  LEFT JOIN HIGHEST_LANG H ON H.PNAME = S.PNAME
  LEFT JOIN LOWEST_LANG L ON L.PNAME = S.PNAME
)
SELECT DISTINCT * FROM MERGED; --74;
SELECT PNAME FROM PROGRAMMER WHERE SEX = 'M' AND 
EXTRACT(YEAR FROM DOB)=1965 AND DOB = (SELECT Min(DOB) FROM PROGRAMMER WHERE EXTRACT(YEAR FROM DOB)=1965 AND SEX = 'M'); --75
SELECT PNAME FROM PROGRAMMER WHERE SEX = 'F' AND 
EXTRACT(YEAR FROM DOB)=1992 AND DOB = (SELECT MIN(DOB) FROM PROGRAMMER WHERE EXTRACT(YEAR FROM DOB)=1992 AND SEX = 'F'); --76
WITH BIRTHS AS(
  SELECT EXTRACT(YEAR FROM DOB) AS VARSH FROM PROGRAMMER
)
SELECT VARSH FROM BIRTHS GROUP BY VARSH HAVING COUNT(*) = (SELECT MAX(COUNT(*)) FROM BIRTHS GROUP BY VARSH); --77
WITH BIRTHS AS(
  SELECT EXTRACT(MONTH FROM DOB) AS MAHINA , COUNT(*) AS TOTAL FROM PROGRAMMER GROUP BY EXTRACT(MONTH FROM DOB)
)
SELECT MAHINA FROM (SELECT MAHINA , TOTAL FROM  BIRTHS ORDER BY TOTAL DESC) WHERE ROWNUM = 1; --78
WITH PROF1 AS(
  SELECT PROF1 AS "LANG" FROM PROGRAMMER
),
PROF2 AS(
  SELECT PROF2 AS "LANG" FROM PROGRAMMER
),
FINALS AS(
  SELECT PROF1.LANG FROM PROF1 FULL OUTER JOIN PROF2 ON PROF1.LANG = PROF2.LANG
)
SELECT LANG FROM FINALS GROUP BY LANG HAVING COUNT(*) = (SELECT MAX(COUNT(*))FROM FINALS GROUP BY LANG); --79
SELECT PNAME FROM PROGRAMMER WHERE SEX = 'M' AND SALARY < (SELECT AVG(SALARY) FROM PROGRAMMER WHERE SEX = 'F'); --80
SELECT PNAME FROM PROGRAMMER WHERE SEX = 'F' AND SALARY > (SELECT MAX(SALARY) FROM PROGRAMMER WHERE SEX = 'M'); --81
WITH PROF1 AS(
  SELECT PROF1 AS "LANG" FROM PROGRAMMER
),
PROF2 AS(
  SELECT PROF2 AS "LANG" FROM PROGRAMMER
),
FINALS AS(
  SELECT PROF1.LANG FROM PROF1 
  FULL OUTER JOIN PROF2
  ON PROF1.LANG = PROF2.LANG
)
SELECT * FROM FINALS WHERE LANG IS NOT NULL GROUP BY LANG HAVING COUNT(*) = (SELECT MAX(COUNT(*)) FROM FINALS WHERE LANG IS NOT NULL GROUP BY LANG);--82
SELECT DISTINCT CASE WHEN P1.PNAME<=P2.PNAME THEN P1.PNAME ELSE P2.PNAME END AS NAME1, CASE WHEN P1.PNAME > P2.PNAME THEN P1.PNAME ELSE P2.PNAME END AS NAME2 FROM PROGRAMMER P1 , PROGRAMMER P2 WHERE P1.PNAME != P2.PNAME AND P1.SALARY = P2.SALARY; --83
SELECT DISTINCT TITLE FROM SOFTWARE WHERE PNAME IN (SELECT PNAME FROM PROGRAMMER WHERE SALARY>3000); --84
WITH MERGED AS(
  SELECT S.* , P.SEX AS "SEX" FROM SOFTWARE S 
  LEFT JOIN PROGRAMMER P ON S.PNAME = P.PNAME
)
SELECT DISTINCT * FROM MERGED WHERE SEX = 'F' AND DEVELOPING  = 'PASCAL'; --85
SELECT DISTINCT * FROM PROGRAMMER WHERE EXTRACT(YEAR FROM DOJ) < 1990; --86
WITH P_STUDENTS AS (
  SELECT PNAME FROM STUDIES WHERE INSTITUE = 'PRAGATHI'
)
SELECT DISTINCT TITLE FROM SOFTWARE WHERE DEVELOPING = 'C' AND PNAME IN (SELECT PNAME FROM PROGRAMMER  WHERE SEX='F' AND PNAME IN (SELECT  PNAME FROM P_STUDENTS )); --87
WITH NAME_WISE AS(
  SELECT PNAME , COUNT(*)AS "NUM_PACKAGES" , SUM(SOLD) , SUM(SCOST*SOLD) AS "SALES" FROM SOFTWARE GROUP BY PNAME
),
INSTITUTE_WISE AS (
  SELECT P1.PNAME , P1.NUM_PACKAGES AS "NUM_PACKAGES", P1.SALES AS "SALES" , P2.INSTITUE AS "INSTITUTE" FROM NAME_WISE P1
  LEFT JOIN STUDIES P2 ON P1.PNAME = P2.PNAME
)
SELECT INSTITUTE , SUM(NUM_PACKAGES) , SUM(SALES) FROM INSTITUTE_WISE WHERE INSTITUTE IS NOT NULL GROUP BY INSTITUTE; --88 
WITH MERGED AS(
  SELECT S.* , P.SEX AS "SEX" , ST.INSTITUE AS "INSTITUTE" FROM SOFTWARE S
  LEFT JOIN PROGRAMMER P ON P.PNAME = S.PNAME
  LEFT JOIN STUDIES ST ON ST.PNAME = S.PNAME
)
SELECT DISTINCT * FROM MERGED WHERE SEX = 'M' AND INSTITUTE IN (SELECT INSTITUE FROM STUDIES GROUP BY INSTITUE HAVING COUNT(*) = (SELECT MAX(COUNT(*)) FROM STUDIES GROUP BY INSTITUE)); --89
SELECT * FROM PROGRAMMER WHERE ((SEX = 'M' AND EXTRACT(YEAR FROM DOB)<1965) OR (SEX = 'F' AND EXTRACT(YEAR FROM DOB)>1975)); --90
WITH MERGED AS(
  SELECT S.* , P.PROF1 AS PROF1 , P.PROF2 AS PROF2 FROM SOFTWARE S
  LEFT JOIN PROGRAMMER P ON S.PNAME = P.PNAME
)
SELECT DISTINCT * FROM MERGED WHERE DEVELOPING != PROF1 AND DEVELOPING!=PROF2; --91
WITH MALES AS(
  SELECT PNAME FROM PROGRAMMER WHERE SEX = 'M'
)
SELECT DISTINCT * FROM SOFTWARE WHERE PNAME IN (SELECT PNAME FROM MALES) AND PNAME IN (SELECT PNAME FROM STUDIES WHERE INSTITUE = 'SABHARI'); --92
SELECT DISTINCT PNAME FROM PROGRAMMER WHERE PNAME NOT IN (SELECT PNAME FROM SOFTWARE); --93
SELECT SUM(DCOST) FROM SOFTWARE WHERE PNAME IN (SELECT DISTINCT PNAME FROM STUDIES WHERE INSTITUE = 'APPLE'); --94
SELECT DISTINCT PNAME FROM PROGRAMMER WHERE PNAME NOT IN (SELECT PNAME FROM SOFTWARE); --95
WITH MERGED AS(
  SELECT P1.PNAME AS NAME1 , P2.PNAME AS NAME2 , P1.PROF2 AS SALARY1 , P2.PROF2 AS SALARY2 FROM PROGRAMMER P1
  CROSS JOIN PROGRAMMER P2 
)
SELECT DISTINCT NAME1 , NAME2 FROM MERGED WHERE SALARY1 = SALARY2 AND NAME1!=NAME2; --96
WITH MERGED AS(
   SELECT S.* , ST.INSTITUE FROM SOFTWARE S
   LEFT JOIN STUDIES ST ON S.PNAME = ST.PNAME
)
SELECT INSTITUE , SUM(DCOST) FROM MERGED WHERE INSTITUE IS NOT NULL GROUP BY INSTITUE; --97
SELECT DISTINCT INSTITUE FROM STUDIES WHERE PNAME IN (SELECT PNAME FROM SOFTWARE WHERE DCOST = (SELECT MAX(DCOST) FROM SOFTWARE)); --98
WITH LANGS AS(
  SELECT PROF1 AS LANG FROM PROGRAMMER
  UNION
  SELECT PROF2 AS LANG FROM PROGRAMMER
)
SELECT DISTINCT LANG FROM LANGS WHERE LANG NOT IN (SELECT DEVELOPING FROM SOFTWARE); --99
WITH PERSON AS (
  SELECT DISTINCT PNAME FROM SOFTWARE WHERE SCOST*SOLD = (SELECT MAX(SCOST*SOLD) FROM SOFTWARE)
),
COURSE AS(
SELECT DISTINCT PNAME , COURSE FROM STUDIES WHERE PNAME IN (SELECT * FROM PERSON)
),
SALARY AS(
  SELECT SALARY FROM PROGRAMMER WHERE PNAME IN (SELECT * FROM PERSON)
)
SELECT * FROM PERSON , COURSE , SALARY; --100
WITH MERGED AS(
  SELECT P.* , ST.COURSEFEE FROM PROGRAMMER P
  LEFT JOIN STUDIES ST ON P.PNAME = ST.PNAME
)
SELECT PNAME , ROUND(COURSEFEE/SALARY , 0) + 1 AS "NUMBER OF MONTHS" FROM MERGED WHERE SALARY IS NOT NULL AND COURSEFEE IS NOT NULL; --101
SELECT DISTINCT TITLE FROM SOFTWARE WHERE PNAME IN (SELECT PNAME FROM PROGRAMMER WHERE EXTRACT(YEAR FROM SYSDATE) - EXTRACT(YEAR FROM DOJ) < 3); --102
WITH PEOPLE AS (
  SELECT PNAME FROM SOFTWARE WHERE SCOST*SOLD>=50000
)
SELECT ROUND(AVG(SALARY),2) FROM PROGRAMMER WHERE PNAME IN (SELECT * FROM PEOPLE); --103
WITH MIN_STUDENTS AS(
  SELECT PNAME FROM STUDIES WHERE COURSEFEE = (SELECT MIN(COURSEFEE) FROM STUDIES)
)
SELECT DISTINCT TITLE FROM SOFTWARE WHERE PNAME IN (SELECT  * FROM MIN_STUDENTS); --104
WITH MERGED AS (
  SELECT S.* , ST.COURSE FROM SOFTWARE S
  LEFT JOIN STUDIES ST ON S.PNAME = ST.PNAME
)
SELECT DISTINCT * FROM MERGED WHERE PNAME IN (SELECT PNAME FROM SOFTWARE WHERE DCOST = (SELECT MIN(DCOST) FROM SOFTWARE)); --105
SELECT COUNT(*) AS TOTAL_PACKAGES FROM SOFTWARE WHERE PNAME IN (SELECT PNAME FROM PROGRAMMER WHERE SEX = 'F' AND SALARY >= (SELECT MAX(SALARY) FROM PROGRAMMER WHERE SEX = 'M')); --106
WITH BDPS_PROGRAMMERS AS (
  SELECT PNAME FROM STUDIES WHERE INSTITUE = 'BDPS'
),
MOST_EXP AS(
  SELECT PNAME FROM PROGRAMMER WHERE PNAME IN (SELECT * FROM BDPS_PROGRAMMERS) AND EXTRACT(YEAR FROM SYSDATE) - EXTRACT(YEAR FROM DOJ) = (SELECT MAX(EXTRACT(YEAR FROM SYSDATE) - EXTRACT(YEAR FROM DOJ)) FROM PROGRAMMER WHERE PNAME IN (SELECT * FROM  BDPS_PROGRAMMERS))
)
SELECT COUNT(*) AS TOTAL_SOFTWARES FROM SOFTWARE WHERE PNAME IN (SELECT * FROM MOST_EXP); --107
WITH MERGED AS(
  SELECT S.* ,ST.INSTITUE FROM  SOFTWARE S
  RIGHT JOIN STUDIES ST ON S.PNAME = ST.PNAME
)
SELECT DISTINCT * FROM MERGED WHERE PNAME IS NOT NULL; --108
WITH LANGS AS (
 SELECT PROF1 AS LANG FROM PROGRAMMER 
 UNION ALL
 SELECT PROF2 AS LANG FROM PROGRAMMER
),
GROUPINGS AS(
  SELECT LANG , COUNT(*) AS NUMBER_OF_PROGRAMMERS FROM LANGS GROUP BY LANG
),
GROUPING_SOFTWARE AS(
  SELECT DEVELOPING , COUNT(*) AS NUM_PACKAGES FROM SOFTWARE GROUP BY DEVELOPING
),
MERGED AS(
  SELECT G1.* , G2.NUM_PACKAGES FROM GROUPINGS G1
  LEFT JOIN GROUPING_SOFTWARE G2 ON G1.LANG = G2.DEVELOPING
)
SELECT LANG , NUMBER_OF_PROGRAMMERS , NVL(NUM_PACKAGES , 0) FROM MERGED; --109
WITH GROUPED AS(
  SELECT PNAME , COUNT(*) AS NUM_PACKAGES FROM SOFTWARE GROUP BY PNAME
),
MERGED AS(
   SELECT P.PNAME , G.NUM_PACKAGES FROM PROGRAMMER P
   LEFT JOIN GROUPED G ON P.PNAME = G.PNAME
)
SELECT DISTINCT PNAME , NVL(NUM_PACKAGES,0) AS "NUMBER_OF_PACKAGES" FROM MERGED; --110
